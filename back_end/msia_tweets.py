import twint
import pandas

# all_cities = ["Alam Impian", "Aman Perdana", "Ambang Botanic", "Ampang", "Ara Damansara", "Balakong", "Bandar Botanic", "Bandar Bukit Raja", "Bandar Bukit Tinggi", "Bandar Kinrara", "Bandar Puncak Alam", "Bandar Puteri Klang", "Bandar Puteri Puchong", "Bandar Saujana Putra", "Bandar Sri Damansara", "Bandar Sungai Long", "Bandar Sunway", "Bandar Utama", "Bangi", "Banting", "Batang Berjuntai", "Batang Kali", "Batu Arang", "Batu Caves", "Beranang", "Bukit Jelutong", "Bukit Rahman Putra", "Bukit Rotan", "Bukit Subang", "Cheras", "Country Heights", "Cyberjaya", "Damansara Damai", "Damansara Intan", "Damansara Jaya", "Damansara Kim", "Damansara Perdana", "Damansara Utama", "Denai Alam", "Dengkil", "Glenmarie", "Gombak", "Hulu Langat", "Hulu Selangor", "Jade Hills", "Jenjarom", "Kajang", "Kapar", "Kayu Ara", "Kelana Jaya", "Kerling", "Klang", "Kota Damansara", "Kota Emerald", "Kota Kemuning", "Kuala Kubu Baru", "Kuala Langat", "Kuala Selangor", "Kuang", "Mutiara Damansara", "Nilai", "Petaling Jaya", "Port Klang", "Puchong", "Puchong South", "Pulau Indah ( Pulau Lumut)", "Pulau Carey ", "Pulau Ketam", "Puncak Jalil", "Putra Heights", "Rasa", "Rawang", "Sabak Bernam", "Saujana", "Sekinchan", "Selayang", "Semenyih", "Sepang", "Serdang", "Serendah", "Seri Kembangan", "Setia Alam", "Setia Eco Park", "Shah Alam", "SierraMas", "SS2", "Subang Bestari", "Subang Heights", "Subang Jaya", "Sungai Ayer Tawar", "Sungai Besar", "Sungai Buloh", "Sungai Pelek", "Taman Melawati", "Taman TTDI Jaya", "Tanjong Karang", "Tanjong Sepat", "Telok Panglima Garang", "Tropicana", "Ulu Klang", "USJ", "USJ Heights", "Valenci", "Ayer Baloi", "Ayer Hitam", "Bakri", "Batu Anam", "Batu Pahat", "Bekok", "Benut", "Bukit Gambir", "Bukit Pasir", "Chaah", "Endau", "Gelang Patah", "Gerisek", "Gugusan Taib Andak", "Horizon Hills", "Jementah", "Johor Bahru", "Kahang", "Kampung Kenangan Tun Dr Ismail", "Kluang", "Kota Tinggi", "Kukup", "Kulai", "Labis", "Layang Layang", "Masai", "Medini", "Mersing", "Muar", "Nusajaya", "Pagoh", "Paloh", "Panchor", "Parit Jawa", "Parit Raja", "Parit Sulong", "Pasir Gudang", "Pekan Nanas", "Pengerang", "Permas Jaya", "Plentong", "Pontian", "Puteri Harbour", "Rengam", "Rengit", "Segamat", "Semerah", "Senai", "Senggarang", "Senibong", "Seri Gadang", "Setia Indah", "Setia Tropika", "Simpang Rengam", "Skudai", "Sungai Mati", "Tampoi", "Tangkak", "Ulu Tiram", "Yong Peng", "Beaufort","Beluran","Bongawan","Keningau","Kota Belud","Kota Kinabalu","Kota Kinabatangan","Kota Marudu","Kuala Penyu","Kudat","Kunak","Lahad Datu","Likas","Membakut","Menumbok","Nabawan","Pamol","Papar","Penampang","Pitas","Pulatan","Ranau","Sandakan","Semporna","Sipitang","Tambunan","Tamparuli","Tawau","Tenom","Tuaran", "Ampang","Ampang Hilir","Bandar Damai Perdana","Bandar Menjalara","Bandar Sri Damansara","Bandar Tasik Selatan","Bangsar","Bangsar South","Batu","Brickfields","Bukit Bintang","Bukit Jalil","Bukit Ledang","Bukit Tunku","Chan Sow Lin","Cheras","City Centre","Country Heights Damansara","Damansara","Damansara Heights","Desa Pandan","Desa ParkCity","Desa Petaling","Federal Hill","Jalan Ipoh","Jalan Klang Lama","Jalan Kuching","Jalan Sultan Ismail","Jinjang","Kenny Hills","Kepong","Keramat","KL City","KL Eco City","KL Sentral","KLCC","Kuchai Lama","Mid Valley City","Mont Kiara","Old Klang Road","OUG","Pandan Indah","Pandan Jaya","Pandan Perdana","Pantai","Pekan Batu","Puchong","Salak Selatan","Segambut","Sentul","Seputeh","Serdang","Setapak","Setiawangsa","Solaris Dutamas","Solaris Mont Kiara","Sri Hartamas","Sri Petaling","Sunway SPK","Sungai Besi","Sungai Penchala","Taman Desa","Taman Duta","Taman Melawati","Taman Tun Dr Ismail","Titiwangsa","Wangsa Maju", "Alor Setar","Ayer Hitam","Baling","Bandar Baharu","Bedong","Bukit Kayu Hitam","Guar Chempedak","Gurun","Jitra","Karangan","Kepala Batas","Kodiang","Kota Sarang Semut","Kuala Kedah","Kuala Ketil","Kuala Muda","Kuala Nerang","Kubang Pasu","Kulim","Kupang","Langgar","Langkawi","Lunas","Merbok","Padang Serai","Padang Terap","Pendang","Pokok Sena","Pulau Langkawi","Serdang","Sik","Simpang Empat","Sungai Petani","Univesity Utara","Yan", "Ayer Lanas","Bachok","Cherang Ruku","Dabong","Gua Musang","Jeli","Kem Desa Pahwalan","Ketereh","Kota Bharu","Kuala Balah","Kuala Kerai","Machang","Melor","Pasir Mas","Pasir Puteh","Pulai Chondong","Rantau Panjang","Selising","Tanah Merah","Tawang","Temangan","Tumpat","Wakaf Baru", "Alor Gajah","Asahan","Ayer Keroh","Bandar Hilir","Batu Berendam","Bemban","Bukit Beruang","Durian Tunggal","Jasin","Kuala Linggi","Kuala Sungai Baru","Lubok China","Masjid Tanah","Melaka Tengah","Merlimau","Selandar","Sungai Rambai","Sungai Udang","Tanjong Kling","Ujong Pasir", "Bahau","Bandar Baru Serting","Batang Melaka","Batu Kikir","Gemas","Gemencheh","Jelebu","Jempol","Johol","Juasseh","Kota","Kuala Klawang","Kuala Pilah","Labu","Lenggeng","Linggi","Mantin","Nilai","Pasir Panjang","Pedas","Port Dickson","Rantau","Rembau","Rompin","Sedayan","Senawang","Seremban","Siliau","Simpang Durian","Simpang Pertang","Sri Menanti","Sri Rusa","Tampin","Tanjong Ipoh", "Balok","Bandar Pusat Jengka","Bandar Tun Abdul Razak","Benta","Bentong","Bera","Brinchang","Bukit Fraser","Cameron Highlands","Chenor","Daerah Rompin","Damak","Dong","Genting Highlands","Jerantut","Karak","Kuala Lipis","Kuala Rompin","Kuantan","Lanchang","Lurah Bilut","Maran","Mengkarak","Mentakab","Muadzam Shah","Padang Tengku","Pekan","Raub","Ringlet","Rompin","Sega","Sungai Koyan","Sungai Lembing","Sungai Ruan","Tanah Rata","Temerloh","Triang", "Air Tawar","Alma","Ayer Itam","Bagan Ajam","Bagan Jermal","Bagan Lallang","Balik Pulau","Bandar Perda","Batu Ferringhi","Batu Kawan","Batu Maung","Batu Uban","Bayan Baru","Bayan Lepas","Berapit","Bertam","Bukit Dumbar","Bukit Jambul","Bukit Mertajam","Bukit Minyak","Bukit Tambun","Bukit Tengah","Butterworth","Gelugor","Georgetown","Gertak Sangul","Greenlane","Jawi","Jelutong","Juru","Kepala Batas","Kubang Semang","Mak Mandin","Minden Heights","Nibong Tebal","Pauh Jaya","Paya Terubong","Penaga","Penang Hill","Penanti","Perai","Permatang Kuching","Permatang Pauh","Permatang Tinggi","Persiaran Gurney","Prai","Pulau Betong","Pulau Tikus","Raja Uda","Relau","Scotland","Seberang Jaya","Seberang Perai","Serdang","Simpang Ampat","Sungai Ara","Sungai Bakap","Sungai Dua","Sungai Jawi","Sungai Nibong","Sungai Pinang","Tanjong Tokong","Tanjung Bungah","Tasek Gelugor","Teluk Bahang","Teluk Kumbar","USM","Valdor", "Ayer Tawar","Bagan Datoh","Bagan Serai","Batu Gajah","Batu Kurau","Behrang Stesen","Beruas","Bidor","Bota","Changkat Jering","Changkat Keruing","Chemor","Chenderiang","Chenderong Balai","Chikus","Enggor","Gerik","Gopeng","Hutan Melintang","Intan","Ipoh","Jeram","Kampar","Kampong Gajah","Kampong Kepayang","Kamunting","Kuala Kangsar","Kuala Kurau","Kuala Sepetang","Lahat","Lambor Kanan","Langkap","Lenggong","Lumut","Malim Nawar","Mambang Diawan","Manong","Matang","Menglembu","Padang Rengas","Pangkor","Pantai Remis","Parit","Parit Buntar","Pengkalan Hulu","Pusing","Rantau Panjang","Sauk","Selama","Selekoh","Selinsing","Semanggol","Seri Manjong","Simpang","Sitiawan","Slim River","Sungai Siput","Sungai Sumun","Sungkai","Taiping","Tanjong Piandang","Tanjong Rambutan","Tanjong Tualang","Tanjung Malim","Tapah","Teluk Intan","Temoh","TLDM Lumut","Trolak","Trong","Tronoh","Ulu Bernam","Ulu Kinta", "Ayer Tawar","Bagan Datoh","Bagan Serai","Batu Gajah","Batu Kurau","Behrang Stesen","Beruas","Bidor","Bota","Changkat Jering","Changkat Keruing","Chemor","Chenderiang","Chenderong Balai","Chikus","Enggor","Gerik","Gopeng","Hutan Melintang","Intan","Ipoh","Jeram","Kampar","Kampong Gajah","Kampong Kepayang","Kamunting","Kuala Kangsar","Kuala Kurau","Kuala Sepetang","Lahat","Lambor Kanan","Langkap","Lenggong","Lumut","Malim Nawar","Mambang Diawan","Manong","Matang","Menglembu","Padang Rengas","Pangkor","Pantai Remis","Parit","Parit Buntar","Pengkalan Hulu","Pusing","Rantau Panjang","Sauk","Selama","Selekoh","Selinsing","Semanggol","Seri Manjong","Simpang","Sitiawan","Slim River","Sungai Siput","Sungai Sumun","Sungkai","Taiping","Tanjong Piandang","Tanjong Rambutan","Tanjong Tualang","Tanjung Malim","Tapah","Teluk Intan","Temoh","TLDM Lumut","Trolak","Trong","Tronoh","Ulu Bernam","Ulu Kinta", "Cyberjaya","Putrajaya", "Asajaya","Balingian","Baram","Bau","Bekenu","Belaga","Belawai","Betong","Bintagor","Bintulu","Dalat","Daro","Debak","Engkilili","Julau","Kabong","Kanowit","Kapit","Kota Samarahan","Kuching","Lawas","Limbang","Lingga","Long Lama","Lubok Antu","Lundu","Lutong","Maradong","Marudi","Matu","Miri","Mukah","Nanga Medamit","Niah","Pusa","Roban","Saratok","Sarikei","Sebauh","Sebuyau","Serian","Sibu","Simunjan","Song","Spaoh","Sri Aman","Sundar","Tanjung Kidurong","Tatau", "Besut","Dungun","Hulu Terengganu","Kemaman","Kuala Terengganu","Marang","Setiu","Kerteh"]

all_cities = ["Kuala Lumpur"]

def scrape_by_city(keywords, since, until, outfile):
    unique_cities=set(all_cities) #To get unique cities of country
    cities = sorted(unique_cities) #Sort & convert datatype to list
    for city in cities:
        print(city)
        c = twint.Config()
        c.Search = keywords #search keyword
        c.Since = since
        c.Until = until
        c.Store_csv = True
        c.Output = "./" + outfile
        c.Near = city
        c.Hide_output = True
        c.Count = True
        c.Stats = True
        c.Resume = 'resume.txt'
        twint.run.Search(c)

scrape_by_city('', '2021-01-01 00:00:00', '2021-03-01 00:00:00', '../Malaysia_Tweets_Dataset3.csv')